\chapter{Microscopic TLS Model}
\lofchap{Microscopic TLS Model}
\section{Concept and background}
\section{Potential configuration}


\begin{equation}
    H = -\frac{\hbar^2}{2m_{oxy}}\nabla^2+V(\mathbf{r})
    \label{eq:OHam}
\end{equation}

\begin{figure}[htp]
\centering
\resizebox{0.8\columnwidth}{!}{\includestandalone{figures/mexhatproj}}
\caption[Potential Projections]{\label{fig:mexhatproj}1D double wells (blue, solid) and harmonic wells (red, dashed) can be used to represent simple projections of a 2D potential onto the $x$ and $y$ axes. Left: two projected double wells is an example of a tetra-well. Right: a combination of one double well and a harmonic well reflects the hemi-tetra- case.}
\end{figure}

\section{Finite Grid}
The Streitz Mintmire potential \cite{Streitz1994} is an assemblage of many functional forms and integrals, some of which can only be solved numerically.
Therefore $\nabla^2$ in \cref{eq:OHam} will also require numerical treatment via a finite difference method.

Finite difference algorithms are useful for boundary value problems (where forward and backward methods are usually applied), and for ordinary and partial differential equations.
If the ODE (or PDE) of the form $f(x)$ can be evaluated both left and right of $x$, the central difference method can be used where abscissas are chosen symmetrically about $x$, which takes the form

\begin{equation}
f\,'(x) \approx \frac{f(x+h)-f(x+h)}{2h},\label{eq:simplecdiff}
\end{equation}
where $h$ is some step size.
For an overview of these algorithms, see \onlinecite{Mathews2004}.

Usually methods of low orders (\eg $\mathcal{O}(h^2)$) are sufficient to achieve a comparable results to the original ODE, although this was not the case for some responses of Streitz Mintmire.
A higher order treatment was required.

\subsection{Derivation}
Following the discussion in \onlinecite{Holoborodko2009}: to calculate the numerical derivative of the function $f(x)$ one can approximate the local region about any point $x^*$ by an appropriate polynomial $P_m(x)$.
Derivatives of the polynomial are assumed to be equal to the derivative of the original function: $f\,'(x^*)\approx P\,'_m(x^*)$ and $f\,''(x^*)\approx P\,''_m(x^*)$ \etc

Sampling $f(x)$ at $N$ abscissas (where $N$ is odd) equidistant from $x^*$ such that

\begin{equation}
f_k = f(x_k), \quad x_k=x^*+kh, \quad \left\{k \in \mathds{Z} \vert -(N-1)/2 \leq k \leq  (N-1)/2 \right\}
\end{equation}

and interpolating points $\{(x_k,f_k)\}$ by a polynomial of degree $N-1$
\begin{equation}
P_{N-1}(x)=\sum_{j=0}^{N-1} a_j x^j,
\end{equation}

a solution can be found by obtaining the set of coefficients $\{a_j\}$ for the system of linear equations
\begin{equation}
\left\{P_{N-1}(x_k)=f_x\right\}.
\label{eq:ploylinset}
\end{equation}

For reasons outlined \emph{vide infra} in \cref{sec:cdiffstep}, a centered formula of order $\mathcal{O}(h^6)$ is needed to obtain the error tolerance required to solve \cref{eq:OHam}, thus a $N=7$ point calculation.

The interpolating parabola \cref{eq:ploylinset} are

\begin{align}
&\begin{cases}
    P_7(-3h) &= \quad f_{-3}\\
    P_7(-2h) &= \quad f_{-2}\\
    P_7(-h) &= \quad f_{-1}\\
    P_7(0) &= \quad f_{0}\\
    P_7(h) &= \quad f_{1}\\
    P_7(2h) &= \quad f_{2}\\
    P_7(3h) &= \quad f_{3}
  \end{cases} \nonumber \displaybreak[0]\\[0.2cm]
  \Rrightarrow
  &\begin{cases}
    a_0 - 3a_1h + 9a_2h^3 - 27a_3h^3 + 81a_4h^4 - 243a_5h^5 + 729a_6h^6 &= f_{-3}\\
    a_0 - 2a_1h + 4a_2h^2 - 8a_3h^3 + 16a_4h^4 - 32a_5h^5 + 64a_6h^6 &= f_{-2}\\
    a_0 - a_1h + a_2h^2 - a_3h^3 + a_4h^4 - a_5h^5 + a_6h^6 &= f_{-1}\\
    a_0 &= f_{0}\\
    a_0 + a_1h + a_2h^2 + a_3h^3 + a_4h^4 + a_5h^5 + a_6h^6 &= f_{1}\\
    a_0 + 2a_1h + 4a_2h^2 + 8a_3h^3 + 16a_4h^4 + 32a_5h^5 + 64a_6h^6 &= f_{2}\\
    a_0 + 3a_1h + 9a_2h^3 + 27a_3h^3 + 81a_4h^4 + 243a_5h^5 + 729a_6h^6 &= f_{3}
  \end{cases}
\end{align}

Solving this set of simultaneous equations for $\{a_j\}$ yields
\begin{equation}
\begin{dcases}
a_0 &= f_{0}\\
a_1 &= \frac{-f_{-3}+9f_{-2}-45f_{-1}+45f_{1}-9f_{2}+f_{3}}{12h}\\
a_2 &= \frac{2f_{-3}-27f_{-2}+270f_{-1}-490f_{0}+270f_{1}-27f_{2}+2f_{3}}{360h^2}\\
&\vdots
\end{dcases}
\end{equation}

Assuming $x^* = 0$ for simplicity, it's clear that $f\,'(0) \approx P\,'_7(0) = a_1$ and therefore

\begin{equation}
\begin{split}
f\,''(0)&\approx P\,''_7(0)=2a_2\\
&=\frac{2f_{-3}-27f_{-2}+270f_{-1}-490f_{0}+270f_{1}-27f_{2}+2f_{3}}{180h^{2}}+E_{trunc}(f,h).
\label{eq:cdiffe}
\end{split}
\end{equation}

\subsection{Truncation Error}\label{sec:truncerr}

The truncation error $\cramped{E_{trunc}(f,h)}$ is a consequence of curtailing the interpolating parabola to the $(N-1)th$ degree.
The above method, whilst concise and practical for obtaining the $N$ point central formula, is not the entire picture.
An alternative, more general approach is to start with Taylor expansions about $x$ for $f(x_k)$~\cite{Cyrus1968,Mathews2004}.
For second derivative solutions, $N+1$ degree expansions are required in the form $f(x) = P_7(x)+E_7(x)$.

%{\mathindent=0.2cm
\begin{align}
\MoveEqLeft f(x\pm h) = \nonumber\\
&f(x)\pm f\,'(x)h+\frac{f\,^{''}(x)h^2}{2!}\pm \frac{f\,^{(3)}(x)h^3}{3!}+\frac{f\,^{(4)}(x)h^4}{4!}\pm \frac{f\,^{(5)}(x)h^5}{5!}\nonumber\\
&+\frac{f\,^{(6)}(x)h^6}{6!}\pm \frac{f\,^{(7)}(x)h^7}{7!}+\frac{f\,^{(8)}(x)h^8}{8!}+\mathcal{O}(h^9)\displaybreak[0]\\[0.2cm]
\MoveEqLeft f(x\pm 2h) = \nonumber\\
&f(x)\pm 2f\,'(x)h+\frac{4f\,^{''}(x)h^2}{2!}\pm \frac{8f\,^{(3)}(x)h^3}{3!}+\frac{16f\,^{(4)}(x)h^4}{4!}\pm \frac{32f\,^{(5)}(x)h^5}{5!}\nonumber\\
&+\frac{64f\,^{(6)}(x)h^6}{6!}\pm \frac{128f\,^{(7)}(x)h^7}{7!}+\frac{256f\,^{(8)}(x)h^8}{8!}+\mathcal{O}(h^9)\displaybreak[0]\\[0.2cm]
\MoveEqLeft f(x\pm 3h) = \nonumber\\
&f(x)\pm 3f\,'(x)h+\frac{9f\,^{''}(x)h^2}{2!}\pm \frac{27f\,^{(3)}(x)h^3}{3!}+\frac{81f\,^{(4)}(x)h^4}{4!}\pm \frac{243f\,^{(5)}(x)h^5}{5!}\nonumber\\
&+\frac{729f\,^{(6)}(x)h^6}{6!}\pm \frac{2187f\,^{(7)}(x)h^7}{7!}+\frac{6561f\,^{(8)}(x)h^8}{8!}+\mathcal{O}(h^9)
\end{align}
%}

Taking the difference between each set of expansions at this juncture would allow one to obtain the first derivative, however the second derivative is required in this instance.
Summing the terms will remove the odd degree terms

\begin{align}
\MoveEqLeft f(x+h)+f(x-h) = 2f(x)+f\,^{''}(x)h^2\nonumber \\ &+\frac{2f\,^{(4)}(x)h^4}{4!}+\frac{2f\,^{(6)}(x)h^6}{6!}+\frac{2f\,^{(8)}(x)h^8}{8!}+\mathcal{O}(h^9)\label{eq:fxh}\displaybreak[0]\\[0.2cm]
\MoveEqLeft f(x+2h)+f(x-2h) = 2f(x)+4f\,^{''}(x)h^2\nonumber \\
&+\frac{32f\,^{(4)}(x)h^4}{4!}+\frac{128f\,^{(6)}(x)h^6}{6!}+\frac{512f\,^{(8)}(x)h^8}{8!}+\mathcal{O}(h^9)\label{eq:fx2h}\displaybreak[0]\\[0.2cm]
\MoveEqLeft f(x+3h)+f(x-3h) = 2f(x)+9f\,^{''}(x)h^2\nonumber \\
&+\frac{162f\,^{(4)}(x)h^4}{4!}+\frac{1458f\,^{(6)}(x)h^6}{6!}+\frac{13122f\,^{(8)}(x)h^8}{8!}+\mathcal{O}(h^9)\label{eq:fx3h}
\end{align}

leaving a set of equations with fourth and sixth degree terms which need be eliminated in order to arrive at an equation similar to \cref{eq:cdiffe}.
The series can also be truncated at this point at the eighth degree term, which exists at points $\{c_k\}$.
The equation $72\times$\cref{eq:fx2h}$-2\times$\cref{eq:fx3h}$-270\times$\cref{eq:fxh} (changing to the $f_k$ convention) yields

\begin{align}
\MoveEqLeft 27f_{2}+27f_{-2}-2f_{3}-2f_{-3}-270f_{1}-270f_{-1} = \nonumber\\
&-490f(x)-180f\,''(x)h^2+\frac{13824f^{(8)}(c_2)-26244f^{(8)}(c_3)-540f^{(8)}(c_1)}{8!}\label{eq:truncsim}
\end{align}

If $f \in \mathds{C}^N [a,b]$, then it follows that $\{x_k\} \in [a,b]$.
Furthermore, $\exists c = \{c_k\} \in [a,b]$ such that if $f^{(8)}(x)$ has one sign and its magnitude does not change rapidly, $c \in [x-3h,x+2h]$

\begin{equation}
 13824f\,^{(8)}(c_2)-26244f\,^{(8)}(c_3)-540f\,^{(8)}(c_1) = -12960f\,^{(8)}(c).\label{eq:ctrunc}
\end{equation}

Equation \cref{eq:ctrunc} can now be substituted into \cref{eq:truncsim} and the result solved for $f\,''(x)$

\begin{equation}
f\,''(x) = \frac{2f_{-3}-27f_{-2}+270f_{-1}-490f_{0}+270f_{1}-27f_{2}+2f_{3}}{180h^{2}}-\frac{f\,^{(8)}(c)h^6}{560},\label{eq:sptetrunc}
\end{equation}

resulting in the truncation error

\begin{equation}
E_{trunc}(f,h) = -\frac{f\,^{(8)}(c)h^6}{560} = \mathcal{O}(h^6).\label{eq:etrunc}
\end{equation}

\subsection{Round-off Error and Step Size Optimisation}\label{sec:cdiffstep}

Computers also introduce floating point round-off errors into the mix, thus truncation is not the only error source that needs to be addressed.
Let $f_k = y_k +e_k$, where $e_k$ is defined as the error in computing $f(x_k)$. With this treatment, \cref{eq:sptetrunc} can be expanded to
\begin{align}
\MoveEqLeft f\,''(x_0) = \nonumber\\
&\frac{2y_{-3}-27y_{-2}+270y_{-1}-490y_{0}+270y_{1}-27y_{2}+2y_{3}}{180h^{2}}+E(f,h),\label{eq:sptye}
\end{align}

where the error term now includes both round-off and truncation errors

\begin{align}
\MoveEqLeft E(f,h) = \nonumber\\
&\frac{2e_{-3}-27e_{-2}+270e_{-1}-490e_{0}+270e_{1}-27e_{2}+2e_{3}}{180h^{2}}-\frac{f\,^{(8)}(c)h^6}{560}.
\end{align}

Each error $e_k$ is assumed to be cumulative and of the same magnitude $\epsilon$ \ie $\abs{e_k} \leq \epsilon$.
To bound the error, a second assumption can be imposed on the truncation such that $\abs{f\,^{(8)}(c)} \leq M$ to introduce the condition

\begin{equation}
\abs{E(f,h)} \leq \frac{272\epsilon}{45h^2}+\frac{Mh^6}{560}.\label{eq:cdifferrtot}
\end{equation}

It's clear from \cref{eq:cdifferrtot} that the truncation and round-off errors are inversely proportional (but not equal) for any choice of $h$, which is commonly referred to as the \emph{step-size dilemma}.
Expanding the central difference formula to $\mathcal{O}(h^6)$ increases the accuracy of over simpler methods like \cref{eq:simplecdiff} (which is $\mathcal{O}(h^2)$), where for a smaller $h$, the round-off error increases as the truncation error decreases at the same rate.

An optimal step size $h$ can be found which minimises the right hand side of \cref{eq:cdifferrtot}. Let

\begin{align}
g(h) &= \frac{272\epsilon}{45h^2}+\frac{Mh^6}{560}\\[0.2cm]
g'(h) &= \frac{544\epsilon}{45h^3}+\frac{3Mh^5}{280}.
\end{align}

Setting $g'(h) = 0$ and solving for $h$ obtains the optimal step:

\begin{equation}
h = \left(\frac{30464\epsilon}{27M}\right)^{1/8}.\label{eq:stepgen}
\end{equation}
for particular values of the error magnitude $\epsilon$ and the maximal truncation bound $M = \mathrm{max}_{[a,b]}\left(\abs{f\,^{(8)}(c)}\right)$.

Since there is no completely analytic form of Streitz Mintmire, finding the truncation bound directly via its eighth derivative is unfeasible.
However, the functional form does not differ from a harmonic oscillator far away from the origin (see section \xxx{Add in the mex hat section}x and \cref{fig:mexhatproj}) -- which has a simple analytic solution and can serve as an analogue.

The hamiltonian of particle in a one dimensional quantum harmonic oscillator can be described as

\begin{equation}
\widehat{H} = \frac{\widehat{p}^2}{2m}+\frac{1}{2}m\omega^2\widehat{x}^2\label{eq:hamho}
\end{equation}

where $m$ is the particle's mass and $ω$ is the angular frequency of the oscillator.
Two operators, $\widehat{x} = x$ for position and $\widehat{p} = -i\hbar \frac{\partial}{\partial x}$ for momentum describe the complete Schr\"{o}dinger equation, which (after separation of variables) takes its time independent form:

\begin{equation}
-\frac{\hbar^2}{2m}\frac{\partial^2 \Psi}{\partial x^2}+\frac{1}{2}m\omega^2x^2 \Psi = E\Psi,
\end{equation}

with the family of solutions for the wavefunctions
\begin{equation}\psi_n(x) = \frac{1}{\sqrt{2^n\,n!}}\left(\frac{m\omega}{\hbar\pi}\right)^{1/4}e^{
- \frac{m\omega x^2}{2 \hbar}} H_n\left(\sqrt{\frac{m\omega}{\hbar}} x \right),\qquad n = 0,1,2,\ldots\\
H_n(x)=(-1)^n e^{x^2}\frac{\mathrm{d}^n}{\mathrm{d}x^n}\left(e^{-x^2}\right)
\end{equation}

Selecting the ground state ($n=0$) and differentiating to the eighth degree, the equation that will satisfy the truncation bound is

\begin{align}
\MoveEqLeft \Psi_0^{(8)}(x) = \nonumber\\
&\left(\frac{m\omega}{\hbar^2}\right)^4\left(\frac{m\omega}{\hbar\pi}\right)^{1/4}\left[(m\omega x^2)^4-28 (m\omega x^2)^3\hbar\right.\nonumber\\
&\left.+210(m\omega x^2)^2\hbar ^2-420m\omega x^2\hbar^3+105\hbar^4\right]e^{-\frac{m\omega x^2}{2\hbar}}.
\label{eq:eightwfn}
\end{align}

The functional form of \cref{eq:eightwfn} indicates a maximal value at $x=0$ such that

\begin{equation}
M = \lim_{x \to 0} \abs{\Psi_0^{(8)}(x)} = \abs{105\left(\frac{m\omega}{\hbar^2}\right)^4\left(\frac{m\omega}{\hbar\pi}\right)^{1/4}}
\label{eq:Mlimit}
\end{equation}
recalling $M = \mathrm{max}_{[a,b]}\left(\abs{f\,^{(8)}(c)}\right)$.

An approximation of the harmonic oscillator using the Hamiltonian \cref{eq:hamho} is valid near the minimum of any potential function, thus

\begin{align}
V(x) &= \frac{1}{2}m\omega^2\hat{x}^2, \qquad \omega=\sqrt{\frac{k}{m}}\label{eq:vharm}\\
     &= \frac{1}{2}k\hat{x}^2
\end{align}

can be connected to the Streitz Mintmire potential through the relationship $V(x_{0})=V_{SM}(x_{0})$, if Streitz Mintmire has one local minima at $x=0$.

As discussed in \xxx{Section on units}, $V_{SM}$ is measured in [μeV] with $x$ in [Å], whereas $V$ is measured in [J] against [m].
Converting a Streitz Mintmire configuration to this unit scheme and fitting a parabola to the minima, a value of $k=938$ is found.
\Cref{fig:harmsm} shows the fit for this value, which is comparatively representational to a large range of cluster configurations.

\begin{figure}[htp]
\centering
\hspace{-1cm}\resizebox{0.7\columnwidth}{!}{\includestandalone{figures/harmsm}}
\caption[Harmonic Approximation to Strietz Mintmire]{\label{fig:harmsm}A parabolic fit to the minima of a 1D Strietz Mintmire potential.}
\end{figure}

<<<<<<< HEAD
The associated angular frequency is therefore
\begin{equation}
\omega=\sqrt{\frac{938}{2.65\ten{-26}}}=1.879\ten{14}
\end{equation}
using the mass of an oxygen atom, which can now be used to solve \cref{eq:Mlimit} for $M = 1.847\ten{98}$.
The final term yet to be discussed from \cref{eq:cdifferrtot} is $\epsilon$.
=======
The associated angular frequency is therefore 
\begin{equation}
\omega=\sqrt{\frac{938}{2.65\ten{-26}}}=1.879\ten{14}
\end{equation}
using the mass of an oxygen atom, which can now be used to solve \cref{eq:Mlimit} for $M = 1.847\ten{98}$. 
The final term yet to be discussed from \cref{eq:cdifferrtot} is $\epsilon$. 
>>>>>>> Text additions
This value is the floating-point relative accuracy of the platform and software under which the central difference is being performed.
On various \texttt{Linux} distributions and \texttt{Windows 7}, \texttt{Matlab 2014b} provides two values for $\epsilon$: single precision $\epsilon_s = 1.192\ten{-7}$ and double $\epsilon_d = 2.220\ten{-16}$.

...

More complex error analysis to be found in \cite{Mathur2012}



