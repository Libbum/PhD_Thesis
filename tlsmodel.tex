\chapter{Microscopic TLS Model}
\section{Concept and background}
\section{Potential configuration}


\begin{equation}
    H = -\frac{\hbar^2}{2m_{oxy}}\nabla^2+V(\mathbf{r})
    \label{eq:OHam}
\end{equation}

\begin{figure}[htp]
\centering
\resizebox{0.8\columnwidth}{!}{\includestandalone{figures/mexhatproj}}
\caption{\label{fig:mexhatproj}1D double wells (blue, solid) and harmonic wells (red, dashed) can be used to represent simple projections of a 2D potential onto the $x$ and $y$ axes. Left: two projected double wells is an example of a tetra-well. Right: a combination of one double well and a harmonic well reflects the hemi-tetra- case.}
\end{figure}

\section{Finite Grid}
The Streitz Mintmire potential \cite{Streitz1994} is an assemblage of many functional forms and integrals, some of which can only be solved numerically.
Therefore $\nabla^2$ in \cref{eq:OHam} will also require numerical treatment via a finite difference method.

Finite difference algorithms are useful for boundary value problems (where forward and backward methods are usually applied), and for ordinary and partial differential equations.
If the ODE (or PDE) of the form $f(x)$ can be evaluated both left and right of $x$, the central difference method can be used where abscissas are chosen symmetrically about $x$, which takes the form

\begin{equation}
f\,'(x) \approx \frac{f(x+h)-f(x+h)}{2h},\label{eq:simplecdiff}
\end{equation}
where $h$ is some step size.
For an overview of these algorithms, see \onlinecite{Mathews2004}.

Usually methods of low orders (\eg $\mathcal{O}(h^2)$) are sufficient to achieve a comparable results to the original ODE, although this was not the case for some responses of Streitz Mintmire.
A higher order treatment was required.

\subsection{Derivation}
Following the discussion in \onlinecite{Holoborodko2009}: to calculate the numerical derivative of the function $f(x)$ one can approximate the local region about any point $x^*$ by an appropriate polynomial $P_m(x)$.
Derivatives of the polynomial are assumed to be equal to the derivative of the original function: $f\,'(x^*)\approx P\,'_m(x^*)$ and $f\,''(x^*)\approx P\,''_m(x^*)$ \etc

Sampling $f(x)$ at $N$ abscissas (where $N$ is odd) equidistant from $x^*$ such that

\begin{equation}
f_k = f(x_k), \quad x_k=x^*+kh, \quad \left\{k \in \mathds{Z} \vert -(N-1)/2 \leq k \leq  (N-1)/2 \right\}
\end{equation}

and interpolating points $\{(x_k,f_k)\}$ by a polynomial of degree $N-1$
\begin{equation}
P_{N-1}(x)=\sum_{j=0}^{N-1} a_j x^j,
\end{equation}

a solution can be found by obtaining the set of coefficients $\{a_j\}$ for the system of linear equations
\begin{equation}
\left\{P_{N-1}(x_k)=f_x\right\}.
\label{eq:ploylinset}
\end{equation}

For reasons outlined \emph{vide infra} in \cref{sec:cdiffstep}, a centered formula of order $\mathcal{O}(h^6)$ is needed to obtain the error tolerance required to solve \cref{eq:OHam}, thus a $N=7$ point calculation.

The interpolating parabola \cref{eq:ploylinset} are

\begin{align}
&\begin{cases}
    P_7(-3h) &= \quad f_{-3}\\
    P_7(-2h) &= \quad f_{-2}\\
    P_7(-h) &= \quad f_{-1}\\
    P_7(0) &= \quad f_{0}\\
    P_7(h) &= \quad f_{1}\\
    P_7(2h) &= \quad f_{2}\\
    P_7(3h) &= \quad f_{3}
  \end{cases} \nonumber \displaybreak[0]\\[0.2cm]
  \Rrightarrow
  &\begin{cases}
    a_0 - 3a_1h + 9a_2h^3 - 27a_3h^3 + 81a_4h^4 - 243a_5h^5 + 729a_6h^6 &= f_{-3}\\
    a_0 - 2a_1h + 4a_2h^2 - 8a_3h^3 + 16a_4h^4 - 32a_5h^5 + 64a_6h^6 &= f_{-2}\\
    a_0 - a_1h + a_2h^2 - a_3h^3 + a_4h^4 - a_5h^5 + a_6h^6 &= f_{-1}\\
    a_0 &= f_{0}\\
    a_0 + a_1h + a_2h^2 + a_3h^3 + a_4h^4 + a_5h^5 + a_6h^6 &= f_{1}\\
    a_0 + 2a_1h + 4a_2h^2 + 8a_3h^3 + 16a_4h^4 + 32a_5h^5 + 64a_6h^6 &= f_{2}\\
    a_0 + 3a_1h + 9a_2h^3 + 27a_3h^3 + 81a_4h^4 + 243a_5h^5 + 729a_6h^6 &= f_{3}
  \end{cases}
\end{align}

Solving this set of simultaneous equations for $\{a_j\}$ yields
\begin{equation}
\begin{dcases}
a_0 &= f_{0}\\
a_1 &= \frac{-f_{-3}+9f_{-2}-45f_{-1}+45f_{1}-9f_{2}+f_{3}}{12h}\\
a_2 &= \frac{2f_{-3}-27f_{-2}+270f_{-1}-490f_{0}+270f_{1}-27f_{2}+2f_{3}}{360h^2}\\
&\vdots
\end{dcases}
\end{equation}

Assuming $x^* = 0$ for simplicity, it's clear that $f\,'(0) \approx P\,'_7(0) = a_1$ and therefore

\begin{equation}
\begin{split}
f\,''(0)&\approx P\,''_7(0)=2a_2\\
&=\frac{2f_{-3}-27f_{-2}+270f_{-1}-490f_{0}+270f_{1}-27f_{2}+2f_{3}}{180h^{2}}+E_{trunc}(f,h).
\label{eq:cdiffe}
\end{split}
\end{equation}

\subsection{Truncation Error}\label{sec:truncerr}

The truncation error $\cramped{E_{trunc}(f,h)}$ is a consequence of curtailing the interpolating parabola to the $(N-1)th$ degree.
The above method, whilst concise and practical for obtaining the $N$ point central formula, is not the entire picture.
An alternative, more general approach is to start with Taylor expansions about $x$ for $f(x_k)$~\cite{Cyrus1968,Mathews2004}.
For second derivative solutions, $N+1$ degree expansions are required in the form $f(x) = P_7(x)+E_7(x)$.

%{\mathindent=0.2cm
\begin{align}
\MoveEqLeft f(x\pm h) = \nonumber\\
&f(x)\pm f\,'(x)h+\frac{f\,^{''}(x)h^2}{2!}\pm \frac{f\,^{(3)}(x)h^3}{3!}+\frac{f\,^{(4)}(x)h^4}{4!}\pm \frac{f\,^{(5)}(x)h^5}{5!}\nonumber\\
&+\frac{f\,^{(6)}(x)h^6}{6!}\pm \frac{f\,^{(7)}(x)h^7}{7!}+\frac{f\,^{(8)}(x)h^8}{8!}+\mathcal{O}(h^9)\displaybreak[0]\\[0.2cm]
\MoveEqLeft f(x\pm 2h) = \nonumber\\
&f(x)\pm 2f\,'(x)h+\frac{4f\,^{''}(x)h^2}{2!}\pm \frac{8f\,^{(3)}(x)h^3}{3!}+\frac{16f\,^{(4)}(x)h^4}{4!}\pm \frac{32f\,^{(5)}(x)h^5}{5!}\nonumber\\
&+\frac{64f\,^{(6)}(x)h^6}{6!}\pm \frac{128f\,^{(7)}(x)h^7}{7!}+\frac{256f\,^{(8)}(x)h^8}{8!}+\mathcal{O}(h^9)\displaybreak[0]\\[0.2cm]
\MoveEqLeft f(x\pm 3h) = \nonumber\\
&f(x)\pm 3f\,'(x)h+\frac{9f\,^{''}(x)h^2}{2!}\pm \frac{27f\,^{(3)}(x)h^3}{3!}+\frac{81f\,^{(4)}(x)h^4}{4!}\pm \frac{243f\,^{(5)}(x)h^5}{5!}\nonumber\\
&+\frac{729f\,^{(6)}(x)h^6}{6!}\pm \frac{2187f\,^{(7)}(x)h^7}{7!}+\frac{6561f\,^{(8)}(x)h^8}{8!}+\mathcal{O}(h^9)
\end{align}
%}

Taking the difference between each set of expansions at this juncture would allow one to obtain the first derivative, however the second derivative is required in this instance.
Summing the terms will remove the odd degree terms

\begin{align}
\MoveEqLeft f(x+h)+f(x-h) = 2f(x)+f\,^{''}(x)h^2\nonumber \\ &+\frac{2f\,^{(4)}(x)h^4}{4!}+\frac{2f\,^{(6)}(x)h^6}{6!}+\frac{2f\,^{(8)}(x)h^8}{8!}+\mathcal{O}(h^9)\label{eq:fxh}\displaybreak[0]\\[0.2cm]
\MoveEqLeft f(x+2h)+f(x-2h) = 2f(x)+4f\,^{''}(x)h^2\nonumber \\
&+\frac{32f\,^{(4)}(x)h^4}{4!}+\frac{128f\,^{(6)}(x)h^6}{6!}+\frac{512f\,^{(8)}(x)h^8}{8!}+\mathcal{O}(h^9)\label{eq:fx2h}\displaybreak[0]\\[0.2cm]
\MoveEqLeft f(x+3h)+f(x-3h) = 2f(x)+9f\,^{''}(x)h^2\nonumber \\
&+\frac{162f\,^{(4)}(x)h^4}{4!}+\frac{1458f\,^{(6)}(x)h^6}{6!}+\frac{13122f\,^{(8)}(x)h^8}{8!}+\mathcal{O}(h^9)\label{eq:fx3h}
\end{align}

leaving a set of equations with fourth and sixth degree terms which need be eliminated in order to arrive at an equation similar to \cref{eq:cdiffe}.
The series can also be truncated at this point at the eighth degree term, which exists at points $\{c_k\}$.
The equation $72\times$\cref{eq:fx2h}$-2\times$\cref{eq:fx3h}$-270\times$\cref{eq:fxh} (changing to the $f_k$ convention) yields

\begin{align}
\MoveEqLeft 27f_{2}+27f_{-2}-2f_{3}-2f_{-3}-270f_{1}-270f_{-1} = \nonumber\\
&-490f(x)-180f\,''(x)h^2+\frac{13824f^{(8)}(c_2)-26244f^{(8)}(c_3)-540f^{(8)}(c_1)}{8!}\label{eq:truncsim}
\end{align}

If $f \in \mathds{C}^N [a,b]$, then it follows that $\{x_k\} \in [a,b]$.
Furthermore, $\exists c = \{c_k\} \in [a,b]$ such that if $f^{(8)}(x)$ has one sign and its magnitude does not change rapidly, $c \in [x-3h,x+2h]$

\begin{equation}
 13824f\,^{(8)}(c_1)-26244f\,^{(8)}(c_3)-540f\,^{(8)}(c_1) = -12960f\,^{(8)}(c).\label{eq:ctrunc}
\end{equation}

Equation \cref{eq:ctrunc} can now be substituted into \cref{eq:truncsim} and the result solved for $f\,''(x)$

\begin{equation}
f\,''(x) = \frac{2f_{-3}-27f_{-2}+270f_{-1}-490f_{0}+270f_{1}-27f_{2}+2f_{3}}{180h^{2}}-\frac{f\,^{(8)}(c)h^6}{560},\label{eq:sptetrunc}
\end{equation}

resulting in the truncation error

\begin{equation}
E_{trunc}(f,h) = -\frac{f\,^{(8)}(c)h^6}{560} = \mathcal{O}(h^6).\label{eq:etrunc}
\end{equation}

\subsection{Round-off Error and Step Size Optimisation}\label{sec:cdiffstep}

Computers also introduce floating point round-off errors into the mix, thus truncation is not the only error source that needs to be addressed.
Let $f_k = y_k +e_k$, where $e_k$ is defined as the error in computing $f(x_k)$. With this treatment, \cref{eq:sptetrunc} can be expanded to
\begin{align}
\MoveEqLeft f\,''(x_0) = \nonumber\\
&\frac{2y_{-3}-27y_{-2}+270y_{-1}-490y_{0}+270y_{1}-27y_{2}+2y_{3}}{180h^{2}}+E(f,h),\label{eq:sptye}
\end{align}

where the error term now includes both round-off and truncation errors

\begin{align}
\MoveEqLeft E(f,h) = \nonumber\\
&\frac{2e_{-3}-27e_{-2}+270e_{-1}-490e_{0}+270e_{1}-27e_{2}+2e_{3}}{180h^{2}}-\frac{f\,^{(8)}(c)h^6}{560}.
\end{align}

Each error $e_k$ is assumed to be cumulative and of the same magnitude $\epsilon$ \ie $\abs{e_k} \leq \epsilon$.
To bound the error, a second assumption can be imposed on the truncation such that $\abs{f\,^{(8)}(c)} \leq M$ to introduce the condition

\begin{equation}
\abs{E(f,h)} \leq \frac{272\epsilon}{45h^2}+\frac{Mh^6}{560}.\label{eq:cdifferrtot}
\end{equation}

It's clear from \cref{eq:cdifferrtot} that the truncation and round-off errors are inversely proportional (but not equal) for any choice of $h$, which is commonly referred to as the \emph{step-size dilemma}.
Expanding the central difference formula to $\mathcal{O}(h^6)$ increases the accuracy of over simpler methods like \cref{eq:simplecdiff} (which is $\mathcal{O}(h^2)$), where for a smaller $h$, the round-off error increases as the truncation error decreases at the same rate.

An optimal step size $h$ can be found which minimises the right hand side of \cref{eq:cdifferrtot}. Let

\begin{align}
g(h) &= \frac{272\epsilon}{45h^2}+\frac{Mh^6}{560}\\[0.2cm]
g'(h) &= \frac{544\epsilon}{45h^3}+\frac{3Mh^5}{280}.
\end{align}

Setting $g'(h) = 0$ and solving for $h$ obtains the optimal step:

\begin{equation}
h = \left(\frac{30464\epsilon}{27M}\right)^{1/8}.\label{eq:stepgen}
\end{equation}
for particular values of the error magnitude $\epsilon$ and the maximal truncation bound $M = \mathrm{max}_{[a,b]}\left(\abs{f\,^{(8)}(c)}\right)$.

Since there is no completely analytic form of Streitz Mintmire, finding the truncation bound directly via its eighth derivative is unfeasible.
However, the functional form does not differ from a harmonic oscillator far away from the origin (see section \xxx{Add in the mex hat section}x and \cref{fig:mexhatproj}) -- which has a simple analytic solution and can serve as an analogue.

The hamiltonian of particle in a one dimensional quantum harmonic oscillator can be described as

\begin{equation}
\widehat{H} = \frac{\widehat{p}^2}{2m}+\frac{1}{2}mw^2\widehat{x}^2\label{eq:hamho}
\end{equation}

where $m$ is the particle's mass and $ω$ is the angular frequency of the oscillator.
Two operators, $\widehat{x} = x$ for position and $\widehat{p} = -i\hbar \frac{\partial}{\partial x}$ for momentum describe the complete Schr\"{o}dinger equation, which (after separation of variables) takes its time independent form:

\begin{equation}
-\frac{\hbar^2}{2m}\frac{\partial^2 \Psi}{\partial x^2}+\frac{1}{2}mw^2x^2 \Psi = E\Psi,
\end{equation}

with the family of solutions for the wavefunctions
\begin{equation}\psi_n(x) = \frac{1}{\sqrt{2^n\,n!}}\left(\frac{m\omega}{\hbar\pi}\right)^{1/4}e^{
- \frac{m\omega x^2}{2 \hbar}} H_n\left(\sqrt{\frac{m\omega}{\hbar}} x \right),\qquad n = 0,1,2,\ldots\\
H_n(x)=(-1)^n e^{x^2}\frac{\mathrm{d}^n}{\mathrm{d}x^n}\left(e^{-x^2}\right)
\end{equation}

Selecting the ground state ($n=0$) and differentiating to the eighth degree

\begin{align}
\MoveEqLeft \Psi_0^{(8)}(x) = \nonumber\\
&\left(\frac{m\omega}{\hbar^2}\right)^4\left(\frac{m\omega}{\hbar\pi}\right)^{1/4}\left[(m\omega x^2)^4-28 (m\omega x^2)^3\hbar\right.\nonumber\\
&\left.+210(m\omega x^2)^2\hbar ^2-420m\omega x^2\hbar^3+105\hbar^4\right]e^{-\frac{m\omega x^2}{2\hbar}}
\end{align}

...

The harmonic potential term

\begin{align}
V(x) &= \frac{1}{2}m\omega^2\hat{x}^2, \qquad \omega=\sqrt{\frac{k}{m}}\label{eq:vharm}\\
     &= \frac{1}{2}k\hat{x}^2
\end{align}

can be connected to the Streitz Mintmire potential through the relationship $V(x_{max})=V_{SM}(x_{max})$, where at a maximum distance $x_{max}$, the harmonic potential is equivalent to Streitz Mintmire.
As discussed in \xxx{Section on $\Lambda$}, $V_{SM}$ is measured in [μeV] with $x$ in [Å], whereas $V$ is measured in [J] against [m].
Unit transformations will therefore need to be carried through this derivation.

\begin{equation}
V_{SM}(x_{max})\cdot10^6\cdot1.602\ten{-19} = \frac{1}{2}k\left(x_{max}\cdot10^{-10}\right)^2\\
\therefore k = \frac{2\!\times\!10^6\cdot1.602\ten{-19}}{10^{-20}}\frac{V_{SM}(x_{max})}{x_{max}^2}.
\end{equation}

Taking a slice of potential space for an arbitrary cluster configuration, $V_{SM}$ is calculated at a maximum value of $x$

\begin{equation}
\frac{V_{SM}(x_{max})}{x_{max}^2} = \frac{3.696\ten{7}}{1.5^2} = 1.643\ten{7} \left[\frac{\text{μeV}}{\text{Å}^2}\right],
\end{equation}

yielding a value for $k = 526.321$. Using the relationship in \cref{eq:vharm} for $\omega$ (where  $\cramped{m=m_{oxy}=2.657\ten{-26}}$ kg), $\omega=1.408\ten{14}$ and a complete equivalency has been found.



\begin{figure}[htp]
\centering
\hspace{-1cm}\resizebox{0.7\columnwidth}{!}{\includestandalone{figures/harmapprox}}
\caption{\label{fig:harmapprox}SM vs Harmonic}
\end{figure}


%Selecting the ground state ($n=0$) and differentiating to the eighth degree and use a nondimesional unit scheme such that energy is in units of $\cramped{E_n \left[\hbar\omega\right]}$ and distance in units of $\cramped{x \left[\sqrt{\hbar/(m\omega)}\right]}$
%
%\begin{equation}
%\Psi_0^{(8)}(x) = \left(\frac{1}{\pi}\right)^{\frac{1}{4}}\left(x^8-28x^6+210x^4-420x^2+105\right)e^{-\frac{x^2}{2}}
%\label{eq:wfndimless}
%\end{equation}
%
%with an associated energy of $E_0 = 1/2$.

%%% COSH

%An approximation of the harmonic oscillator using the Hamiltonian \cref{eq:hamho} is valid near the minimum of any potential function.
%Expanding a general potential $V(x)$ around a minimum $x^*$ gives the Taylor series
%
%\begin{equation}
%V(x) = V_0 +(x-x^*)\left.\frac{\partial V}{\partial x}\right|_{x=x^*}+\frac{1}{2}(x-x^*)^2\left.\frac{\partial V}{\partial^2 x^2}\right|_{x=x^*}+\cdots
%\end{equation}
%
%With a few assumptions, it can be seen from this expansion why the potential can be approximated by a parabola.
%$V_0$ can be taken to zero as an arbitrary constant and the derivative is zero at critical points so the second term is also zero.
%Assuming the variation in the vicinity of the critical point is small all higher terms can be neglected, leaving just the second term.
%
%Using another arbitrary potential, for example a hyperbolic cosine, a hamiltonian of the form
%
%\begin{equation}
%\widehat{H} = \frac{\widehat{p}^2}{2m}+V_0\cosh(x)\label{eq:hamcosh}
%\end{equation}
%
%with a critical point at $x=0$ has the Taylor expansion
%\begin{equation}
%\left.V_0\cosh(x)\right|_{x=0} = V_0+V_0x\sinh(0)+\frac{V_0}{2}x^2\cosh(0)+\mathcal{O}(x^3)
%\end{equation}
%
%such that \cref{eq:hamcosh} can be approximated to
%
%\begin{align}
%\widehat{H} &\approx \frac{\widehat{p}^2}{2m}+\frac{V_0}{2}x^2+V_0\label{eq:hamtexp}\\
%\therefore E_n &\approx \left(n+\frac{1}{2}\right)\hbar\sqrt{\frac{V_0}{m}}+V_0
%\end{align}
%
%As $V_0 \rightarrow 0$ (as it is only an arbitrary scaling constant) it becomes clear that for this potential the dimensionless conversion to the framework of \cref{eq:wfndimless} for energy approximates to $\cramped{E_n \left[\hbar\sqrt{1/m}\right]}$, which through the transformation $\cramped{\omega \approx \sqrt{1/m}}$, the conversion in distance is $\cramped{x \left[\sqrt{\hbar}/\sqrt[4]{m}\right]}$.
%This unit basis removes the dependency on $\omega$, which has no dual in \cref{eq:OHam}.

%%% END COSH
...

As discussed in \xxx{section discussing $\Lambda$ and GR}, an appropriate grid range which captures all if the important physics of the investigated clusters is $\pm 4.5$ Å around a central origin.
Using the above conversion, an appropriate range for the truncation bound can now be found.

\begin{align}
-a &= b = \frac{\sqrt{\hbar}}{\sqrt[4]{m_{oxy}}}\cdot 4.5\ten{-10} = 11.45\\
\therefore M &= \mathrm{max}_{[-11.45,11.45]}\left(\abs{\Psi_0^{(8)}(x)}\right) = 78.87
\end{align}

The final requirement for \cref{eq:stepgen} is an acceptable error magnitude $\epsilon$.

...

if $1$ Hz converted to μeV is acceptable  $\epsilon = 4.14\ten{-9}$
\begin{equation}
h = \left(\frac{30464\cdot4.14\ten{-9}}{27\cdot78.87}\right)^{1/8}=0.13 \approx 0.1\label{eq:stepopti}
\end{equation}
(although we publish $1$ kHz, as we wish to be well above this actual limit).




